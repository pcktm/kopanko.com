---
import Layout from "@layouts/Layout.astro";
import ContentGrid from "@components/ContentGrid.astro";
import { getProjects } from "@lib/cms/projects";
import { Icon } from "astro-icon/components";

const projects = await getProjects();
---

<Layout title="Projects" breadcrumb="projects.sh">
  <main>
    <div class="mb-8">
      <h1 class="text-balance font-redaction20 text-2xl font-bold">
        My projects
      </h1>
      <p class="font-mono text-sm text-balance">
        A bunch of things Iâ€™ve done that I think are pretty cool.
      </p>
    </div>

    <div class="mb-12">
      <div class="font-mono text-xs text-stone-500 dark:text-stone-400 mb-4">
        <span class="text-blue-600 dark:text-blue-400">></span> featured
      </div>
      <ContentGrid content={projects.filter((p) => !p.isMinor)} />
    </div>

    <div class="mb-12">
      <div class="font-mono text-xs text-stone-500 dark:text-stone-400 mb-4">
        <span class="text-blue-600 dark:text-blue-400">></span> more
      </div>
      <div class="flex flex-col gap-4">
        {
          projects
            .filter((p) => p.isMinor)
            .map((project, index) => (
              <div class="flex items-start gap-3">
                <div class="font-mono text-xs text-stone-400 dark:text-stone-500 mt-1">
                  [{String(index + 1).padStart(2, "0")}]
                </div>
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-1">
                    <h1 class="font-redaction20 text-lg font-bold">
                      {project.title}
                    </h1>
                    {project?.action?.url && (
                      <a 
                        href={project.action.url} 
                        class="font-mono text-xs text-blue-600 dark:text-blue-400 hover:underline" 
                        target="_blank"
                      >
                        [{project.action.text}]
                      </a>
                    )}
                  </div>
                  <h2 class="mb-2 font-mono text-sm text-stone-600 dark:text-stone-300">{project.tagline}</h2>
                  <div class="prose prose-sm prose-stone dark:prose-invert font-sans">
                    <Fragment set:html={project.description?.html} />
                  </div>
                </div>
              </div>
            ))
        }
      </div>
    </div>
  </main>
</Layout>
